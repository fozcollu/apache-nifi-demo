[{"line":2,"elements":[{"line":4,"name":"","description":"","type":"background","keyword":"Background","steps":[{"name":"def dbHandler = Java.type('helpers.MongoDbHandler')","result":{"duration":6328600,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"*","line":5,"doc_string":{"content_type":"","value":"08:48:23.651 karate.env system property was: dev \n","line":5}},{"name":"def dataGenerator = Java.type('helpers.DataGenerator')","result":{"duration":4492200,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"*","line":6},{"name":"def rabbitmqHandler = Java.type('helpers.RabbitMQHandler')","result":{"duration":4294000,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"*","line":7},{"name":"def nifiRequestBody = read('classpath:NifiTests\/data\/nifiRequest.json')","result":{"duration":149190300,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"*","line":8},{"name":"def sleep = function(ms){ java.lang.Thread.sleep(ms) }","result":{"duration":3744600,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"*","line":9},{"name":"url apiUrl","result":{"duration":520800,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"Given","line":10}]},{"line":13,"name":"Nifi Test - Check With Code from db","description":"","id":"nifi-test---check-with-code-from-db","type":"scenario","keyword":"Scenario","steps":[{"name":"def code = dataGenerator.getRandomCode()","result":{"duration":138704000,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"Given","line":14},{"name":"set nifiRequestBody.code =  code","result":{"duration":3691600,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"Given","line":15},{"name":"path 'order'","result":{"duration":967400,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"Given","line":16},{"name":"request nifiRequestBody","result":{"duration":386100,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"And","line":17},{"name":"method Post","result":{"duration":961145700,"error_message":"http call failed after 776 milliseconds for url: http:\/\/nifi:8050\/order\nclasspath:NifiTests\/feature\/NifiTest.feature:18","status":"failed"},"match":{"location":"karate","arguments":[]},"keyword":"When","line":18,"doc_string":{"content_type":"","value":"08:48:25.022 request:\n1 > POST http:\/\/nifi:8050\/order\n1 > Content-Type: application\/json; charset=UTF-8\n1 > Content-Length: 2352\n1 > Host: nifi:8050\n1 > Connection: Keep-Alive\n1 > User-Agent: Apache-HttpClient\/4.5.13 (Java\/11.0.10)\n1 > Accept-Encoding: gzip,deflate\n{\"token\":\"5f373562-591a-4db9-8609-7eec7880f28d\",\"code\":\"test-82\",\"comments\":{\"customerComment\":\"Please hurry, I am hungry\",\"vendorComment\":\"\"},\"createdAt\":\"2016-03-14T17:00:00.000Z\",\"customer\":{\"email\":\"s188sduisddsnjknsj\",\"firstName\":\"food\",\"lastName\":\"panda\",\"mobilePhone\":\"+49 99999999\",\"code\":\"dummy_customer_code\",\"id\":\"dummy_customer_Id\",\"mobilePhoneCountryCode\":\"\"},\"delivery\":{\"address\":{\"postcode\":10117,\"city\":\"Berlin\",\"street\":\"Oranienburger Sta√üe\",\"number\":67},\"expectedDeliveryTime\":\"2016-03-14T17:50:00.000Z\",\"expressDelivery\":false,\"riderPickupTime\":\"2016-03-14T17:35:00.000Z\"},\"discounts\":[{\"name\":\"Flat 30% OFF\",\"amount\":\"10,5\",\"type\":\"string\"}],\"expeditionType\":\"pickup\",\"expiryDate\":\"2016-03-14T17:15:00.000Z\",\"extraParameters\":{\"property1\":\"string\",\"property2\":\"string\"},\"localInfo\":{\"countryCode\":\"de\",\"currencySymbol\":\"\\u20AC\",\"platform\":\"Foodpanda\",\"platformKey\":\"FP_MY\",\"currencySymbolPosition\":\"\",\"currencySymbolSpaces\":\"\",\"decimalDigits\":\"\",\"decimalSeparator\":\"\",\"email\":\"\",\"phone\":\"\",\"thousandsSeparator\":\"\",\"website\":\"\"},\"payment\":{\"status\":\"online\",\"type\":\"paid\",\"remoteCode\":\"online\",\"requiredMoneyChange\":\"\",\"vatId\":\"\",\"vatName\":\"\"},\"test\":false,\"shortCode\":\"42\",\"preOrder\":false,\"pickup\":null,\"platformRestaurant\":{\"id\":\"sq-abcd\"},\"price\":{\"deliveryFees\":[{\"name\":\"packaging fee\",\"value\":2.5}],\"grandTotal\":\"25.50\",\"minimumDeliveryValue\":\"9.99\",\"payRestaurant\":\"25.50\",\"riderTip\":\"1.20\",\"subTotal\":\"19.45\",\"vatTotal\":\"2.50\",\"comission\":\"\",\"containerCharge\":\"\",\"deliveryFee\":\"12.80\",\"collectFromCustomer\":\"16.34\",\"discountAmountTotal\":\"2.50\",\"deliveryFeeDiscount\":\"\",\"serviceFeePercent\":\"\",\"serviceFeeTotal\":\"\",\"serviceTax\":0,\"serviceTaxValue\":0,\"differenceToMinimumDeliveryValue\":\"\",\"vatVisible\":true,\"vatPercent\":\"string\"},\"products\":[{\"categoryName\":\"Burgers\",\"name\":\"Double Cheese Burger\",\"paidPrice\":\"8.00\",\"quantity\":\"string\",\"remoteCode\":\"123456\",\"selectedToppings\":[{\"children\":[],\"name\":\"extra cheese\",\"price\":\"1.50\",\"quantity\":0,\"id\":\"string\",\"remoteCode\":null,\"type\":\"PRODUCT\"}],\"unitPrice\":\"6.42\",\"comment\":\"No cheese please\",\"description\":\"\",\"discountAmount\":\"\",\"halfHalf\":false,\"id\":\"string\",\"selectedChoices\":[],\"variation\":{\"name\":\"Double Cheese Burger\"},\"vatPercentage\":\"\"}],\"corporateOrder\":false,\"corporateTaxId\":\"example-tax-id\",\"integrationInfo\":{},\"mobileOrder\":true,\"webOrder\":false,\"vouchers\":[]}\n\n08:48:25.116 karate.org.apache.http.conn.HttpHostConnectException: Connect to nifi:8050 [nifi\/172.21.0.6] failed: Connection refused (Connection refused), http call failed after 776 milliseconds for url: http:\/\/nifi:8050\/order\n08:48:25.118 classpath:NifiTests\/feature\/NifiTest.feature:18\nWhen method Post\nhttp call failed after 776 milliseconds for url: http:\/\/nifi:8050\/order\nclasspath:NifiTests\/feature\/NifiTest.feature:18\n","line":18}},{"name":"status 200","result":{"duration":0,"status":"skipped"},"match":{"location":"karate","arguments":[]},"keyword":"Then","line":19},{"name":"eval sleep(10000)","result":{"duration":0,"status":"skipped"},"match":{"location":"karate","arguments":[]},"keyword":"*","line":20},{"name":"def mongoDbResponse =  karate.toString(karate.toJson(dbHandler.findKeyValue(mongodbInfo, \"code\",code)))","result":{"duration":0,"status":"skipped"},"match":{"location":"karate","arguments":[]},"keyword":"*","line":21},{"name":"print mongoDbResponse","result":{"duration":0,"status":"skipped"},"match":{"location":"karate","arguments":[]},"keyword":"*","line":22},{"name":"match mongoDbResponse contains code","result":{"duration":0,"status":"skipped"},"match":{"location":"karate","arguments":[]},"keyword":"Then","line":23}],"tags":[{"name":"@nifi1","line":12},{"name":"@nifi","line":1}]}],"name":"NifiTests\/feature\/NifiTest.feature","description":"Nifi Test","id":"nifi-test","keyword":"Feature","uri":"NifiTests\/feature\/NifiTest.feature","tags":[{"name":"@nifi","line":1}]}]